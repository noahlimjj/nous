<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nous Arcana: Playground v0.9 (Avatar 2.0)</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://api.fontshare.com/v2/css?f[]=satoshi@300,400,500,700,900&display=swap');

        body {
            font-family: 'Satoshi', sans-serif;
            background: #0f172a;
            color: white;
            overflow: hidden;
        }

        /* --- Animations --- */
        @keyframes float-idle {

            0%,
            100% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-8px) rotate(1deg);
            }
        }

        @keyframes breathe-glow {

            0%,
            100% {
                opacity: 0.3;
                transform: scale(1);
            }

            50% {
                opacity: 0.6;
                transform: scale(1.05);
            }
        }

        @keyframes sword-slash {
            0% {
                transform: rotate(0deg) translateX(0);
            }

            30% {
                transform: rotate(-50deg) translateX(-20px);
            }

            100% {
                transform: rotate(0deg) translateX(0);
            }
        }

        @keyframes damage-shake {
            0% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(5px);
            }

            50% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }

            100% {
                transform: translateX(0);
            }
        }

        @keyframes death-flash {
            0% {
                opacity: 1;
                filter: brightness(1);
            }

            50% {
                opacity: 0;
                filter: brightness(5) sepia(1) hue-rotate(-50deg);
            }

            100% {
                opacity: 1;
                filter: brightness(1);
            }
        }

        .anim-float {
            animation: float-idle 5s ease-in-out infinite;
        }

        .anim-breathe {
            animation: breathe-glow 3s ease-in-out infinite;
        }

        .anim-slash {
            animation: sword-slash 0.4s ease-out;
        }

        .anim-damage {
            animation: damage-shake 0.3s ease-in-out;
        }

        .anim-death {
            animation: death-flash 1s ease-out;
        }

        /* --- Glass Panel --- */
        .glass-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }

        /* --- Rarity Colors --- */
        .rarity-common {
            border-color: #94a3b8;
        }

        .rarity-uncommon {
            border-color: #22c55e;
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.2);
        }

        .rarity-rare {
            border-color: #3b82f6;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
        }

        .rarity-epic {
            border-color: #a855f7;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.4);
        }

        .rarity-legendary {
            border-color: #eab308;
            box-shadow: 0 0 25px rgba(234, 179, 8, 0.5);
            border-width: 2px;
        }

        /* --- Stat Colors --- */
        .stat-str {
            color: #f87171;
        }

        .stat-agi {
            color: #4ade80;
        }

        .stat-int {
            color: #60a5fa;
        }

        .stat-vit {
            color: #f472b6;
        }

        .stat-wis {
            color: #c084fc;
        }

        .stat-luk {
            color: #fbbf24;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Data Layer ---
        const LEVELS = [
            { level: 1, xp: 0, title: "Wayfinder", form: "novice" },
            { level: 2, xp: 100, title: "Seeker", form: "novice" },
            { level: 3, xp: 300, title: "Squire", form: "knight" },
            { level: 4, xp: 600, title: "Knight", form: "knight" },
            { level: 5, xp: 1000, title: "Templar", form: "royal" },
            { level: 6, xp: 1600, title: "Grand Master", form: "royal" },
            { level: 7, xp: 2400, title: "Emperor", form: "emperor" },
            { level: 8, xp: 3500, title: "Ascendant", form: "emperor" }
        ];

        const ITEMS = [
            { id: 'p1', name: 'Focus Tonic', type: 'consumable', cost: 25, val: 30, desc: 'Heal 30 HP', icon: 'üß™', rarity: 'common' },
            { id: 'p2', name: 'Mental Clarity', type: 'consumable', cost: 60, val: 70, desc: 'Heal 70 HP', icon: '‚ú®', rarity: 'uncommon' },
            { id: 'w1', name: 'Iron Will', type: 'gear', slot: 'weapon', cost: 100, stats: { str: 2 }, icon: 'üó°Ô∏è', rarity: 'common' },
            { id: 'a1', name: 'Stoic Robes', type: 'gear', slot: 'armor', cost: 100, stats: { vit: 2 }, icon: 'ü•ã', rarity: 'common' },
            { id: 'b1', name: 'Boots of Haste', type: 'gear', slot: 'feet', cost: 200, stats: { agi: 3 }, icon: 'üë¢', rarity: 'uncommon' },
            { id: 't1', name: 'Tome of Wisdom', type: 'gear', slot: 'offhand', cost: 250, stats: { int: 2, wis: 2 }, icon: 'üìñ', rarity: 'uncommon' },
            { id: 'r1', name: 'Ring of Fortune', type: 'gear', slot: 'ring', cost: 300, stats: { luk: 5 }, icon: 'üíç', rarity: 'rare' },
            { id: 'w2', name: 'Logic Blade', type: 'gear', slot: 'weapon', cost: 550, stats: { str: 6, agi: 2 }, icon: '‚öîÔ∏è', rarity: 'rare' },
            { id: 'a2', name: 'Shield of Habit', type: 'gear', slot: 'offhand', cost: 800, stats: { vit: 8, wis: 4 }, icon: 'üõ°Ô∏è', rarity: 'epic' },
            { id: 'w3', name: 'Nous Calibur', type: 'gear', slot: 'weapon', cost: 1500, stats: { str: 10, vit: 5, luk: 5 }, icon: 'üî±', rarity: 'legendary' },
            { id: 'a3', name: 'Aegis of Flow', type: 'gear', slot: 'armor', cost: 1500, stats: { vit: 10, int: 5, wis: 5 }, icon: 'üí†', rarity: 'legendary' }
        ];

        const ENEMIES = [
            { id: 'e1', name: "Distraction Wisp", hp: 40, dmg: 5, xp: 30, cash: 10, type: 'wisp' },
            { id: 'e2', name: "Procrastination Golem", hp: 120, dmg: 12, xp: 100, cash: 40, type: 'golem' },
            { id: 'e3', name: "Burnout Dragon", hp: 300, dmg: 30, xp: 350, cash: 150, type: 'dragon' },
            { id: 'e4', name: "Entropy Shade", hp: 60, dmg: 8, xp: 50, cash: 20, type: 'shade' },
            { id: 'e5', name: "Chaos Knight", hp: 200, dmg: 18, xp: 200, cash: 80, type: 'knight' },
            { id: 'e6', name: "Sloth Slime", hp: 80, dmg: 6, xp: 60, cash: 25, type: 'slime' }
        ];

        // --- Avatar Component 2.0 (Growtopia/Humanoid Style) ---
        const Avatar = ({ form, action, damaged, customization, equipped }) => {
            const { skin, hair, hairStyle, primary } = customization;
            const groupClass = `transition-transform duration-300 ${damaged ? 'anim-damage' : ''} ${action === 'attack' ? 'anim-slash' : action === 'dodge' ? 'translate-x-10' : 'anim-float'}`;
            const isAttacking = action === 'attack';

            // Helper for held items
            const Weapon = () => {
                if (!equipped || !equipped.weapon) return null;
                const color = equipped.weapon.includes('3') ? '#f59e0b' : equipped.weapon.includes('2') ? '#3b82f6' : '#94a3b8';
                return (
                    <g transform={`rotate(${isAttacking ? -45 : 0} 0 0)`}>
                        <rect x="-2" y="-25" width="4" height="35" fill={color} stroke="#1e293b" strokeWidth="1" />
                        <rect x="-6" y="5" width="12" height="3" fill="#475569" />
                    </g>
                );
            };

            const Offhand = () => {
                if (!equipped || !equipped.offhand) return null;
                return <rect x="-8" y="-10" width="16" height="20" fill="#a78bfa" stroke="#fff" strokeWidth="1" />;
            };

            return (
                <svg viewBox="0 0 100 100" className={`w-64 h-64 drop-shadow-2xl ${groupClass}`}>
                    <defs>
                        <linearGradient id="metalGrad" x1="0" y1="0" x2="1" y2="1">
                            <stop offset="0%" stopColor="#cbd5e1" />
                            <stop offset="100%" stopColor="#475569" />
                        </linearGradient>
                    </defs>
                    <g>
                        {/* LEGS */}
                        <path d="M40,75 L40,90 L48,90 L48,75 Z" fill="#334155" />
                        <path d="M52,75 L52,90 L60,90 L60,75 Z" fill="#334155" />

                        {/* FEET */}
                        <path d="M38,90 L48,90 L48,95 L38,95 Z" fill={(equipped && equipped.feet) ? "#f59e0b" : "#0f172a"} />
                        <path d="M52,90 L62,90 L62,95 L52,95 Z" fill={(equipped && equipped.feet) ? "#f59e0b" : "#0f172a"} />

                        {/* TORSO */}
                        <rect x="38" y="50" width="24" height="28" rx="4" fill={primary} />
                        {(equipped && equipped.armor) && <rect x="38" y="50" width="24" height="28" rx="4" fill="url(#metalGrad)" opacity="0.8" />}

                        {/* ARMS (Back) */}
                        <path d="M60,55 L75,65" stroke={skin} strokeWidth="6" strokeLinecap="round" />

                        {/* HELD ITEM (Right) */}
                        <g transform="translate(75, 65)"><Weapon /></g>

                        {/* HEAD */}
                        <circle cx="50" cy="35" r="14" fill={skin} />
                        <circle cx="45" cy="35" r="2" fill="#1e293b" />
                        <circle cx="55" cy="35" r="2" fill="#1e293b" />

                        {/* HAIR */}
                        {hairStyle === 'spiky' && <path d="M35,30 L30,20 L40,25 L50,15 L60,25 L70,20 L65,30 Z" fill={hair} />}
                        {hairStyle === 'flow' && <path d="M35,20 Q50,10 65,20 L65,40 Q50,50 35,40 Z" fill={hair} />}
                        {hairStyle === 'ponytail' && <circle cx="65" cy="30" r="6" fill={hair} />}

                        {/* ARMS (Front) */}
                        <path d="M40,55 L25,65" stroke={skin} strokeWidth="6" strokeLinecap="round" />

                        {/* HELD ITEM (Left) */}
                        <g transform="translate(25, 65)"><Offhand /></g>
                    </g>
                </svg>
            );
        };

        const StatBadge = ({ lbl, val, color }) => (
            <div className="flex justify-between items-center w-full mb-1 border-b border-white/5 pb-1 last:border-0">
                <span className="text-[10px] uppercase font-bold text-slate-500">{lbl}</span>
                <span className={`text-xs font-bold ${color}`}>{val}</span>
            </div>
        );

        // --- Main App ---
        const App = () => {
            const [xp, setXp] = useState(0);
            const [cash, setCash] = useState(500);
            const [hp, setHp] = useState(100);
            const [customization, setCustomization] = useState({ skin: '#fca5a5', hair: '#fcd34d', hairStyle: 'spiky', primary: '#60a5fa' });
            const [showEditor, setShowEditor] = useState(false);
            const [inventory, setInventory] = useState([]);
            const [equipped, setEquipped] = useState({ weapon: null, armor: null, offhand: null, feet: null, ring: null });
            const [logs, setLogs] = useState([{ id: 0, msg: "Welcome to Nous Arcana.", type: 'system' }]);
            const [monster, setMonster] = useState(null);
            const [playerAction, setPlayerAction] = useState('idle');
            const [monsterAction, setMonsterAction] = useState('idle');

            const addLog = (msg, type = 'info') => setLogs(prev => [{ id: Date.now(), msg, type }, ...prev].slice(0, 8));
            const formatMoney = (amount) => `${Math.floor(amount)} ü™ô`;

            const stats = useMemo(() => {
                let base = { str: 1, agi: 1, int: 1, vit: 1, wis: 1, luk: 1 };
                Object.values(equipped).forEach(itemId => {
                    const item = inventory.find(i => i.id === itemId);
                    if (item && item.stats) {
                        for (let k in item.stats) base[k] += item.stats[k];
                    }
                });
                return base;
            }, [equipped, inventory]);

            const maxHp = 100 + (stats.vit * 10);
            const damage = 5 + (stats.str * 3);
            const dodgeChance = stats.agi * 2;
            const critChance = (stats.luk * 2);
            const xpMultiplier = 1 + (stats.int * 0.05);
            const hpRegen = stats.wis;
            const cashDropMult = 1 + (stats.luk * 0.1);

            const levelInfo = useMemo(() => {
                const current = LEVELS.slice().reverse().find(l => xp >= l.xp) || LEVELS[0];
                const next = LEVELS.find(l => l.level === current.level + 1);
                return { current, next };
            }, [xp]);

            const progress = useMemo(() => {
                if (!levelInfo.next) return 100;
                return Math.min(100, ((xp - levelInfo.current.xp) / (levelInfo.next.xp - levelInfo.current.xp)) * 100);
            }, [xp, levelInfo]);

            const handleEquip = (item) => {
                if (item.type !== 'gear') return;
                const isEquipped = equipped[item.slot] === item.id;
                setEquipped(p => ({ ...p, [item.slot]: isEquipped ? null : item.id }));
            };

            const buy = (item) => {
                if (inventory.some(i => i.id === item.id) && item.type !== 'consumable') return;
                if (cash < item.cost) { addLog("Insufficient Funds", 'warning'); return; }
                setCash(p => p - item.cost);
                if (item.type === 'consumable') {
                    setHp(p => Math.min(maxHp, p + item.val));
                    addLog(`Consumed ${item.name}`, 'success');
                } else {
                    setInventory(p => [...p, item]);
                    addLog(`Bought ${item.name}!`, 'success');
                }
            };

            const combatRound = () => {
                if (!monster) return;
                const rollCrit = (Math.random() * 100) < critChance;
                const finalDmg = rollCrit ? damage * 2 : damage;
                setPlayerAction('attack');
                setTimeout(() => setPlayerAction('idle'), 400);

                const newHp = monster.currentHp - finalDmg;
                if (newHp <= 0) {
                    setMonster(null);
                    setXp(p => p + monster.xp * xpMultiplier);
                    setCash(p => p + monster.cash * cashDropMult);
                    addLog(`Victory!`, 'success');
                    if (hp < maxHp) setHp(p => Math.min(maxHp, p + hpRegen));
                } else {
                    setMonster(p => ({ ...p, currentHp: newHp }));
                    setTimeout(() => {
                        setMonsterAction('attack');
                        setTimeout(() => setMonsterAction('idle'), 400);
                        const rollDodge = (Math.random() * 100) < dodgeChance;
                        if (rollDodge) {
                            addLog(`Dodged attack!`, 'success');
                            setPlayerAction('dodge');
                            setTimeout(() => setPlayerAction('idle'), 400);
                        } else {
                            setHp(p => Math.max(0, p - monster.dmg));
                        }
                    }, 500);
                }
            };

            const Editor = () => (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm">
                    <div className="bg-slate-900 rounded-2xl border border-slate-700 p-8 w-96 max-w-full shadow-2xl relative">
                        <button onClick={() => setShowEditor(false)} className="absolute top-4 right-4 text-slate-400 hover:text-white">‚úï</button>
                        <h2 className="text-xl text-white mb-6 tracking-widest uppercase">Style Your Hero</h2>
                        <div className="mb-4">
                            <label className="text-xs text-slate-500 uppercase font-bold block mb-2">Skin Tone</label>
                            <div className="flex gap-2">
                                {['#fca5a5', '#fdba74', '#d4d4d8', '#a16207', '#57534e'].map(c =>
                                    <button key={c} onClick={() => setCustomization(p => ({ ...p, skin: c }))} className={`w-8 h-8 rounded-full border-2 ${customization.skin === c ? 'border-white' : 'border-transparent'}`} style={{ background: c }} />
                                )}
                            </div>
                        </div>
                        <div className="mb-4">
                            <label className="text-xs text-slate-500 uppercase font-bold block mb-2">Hair Color</label>
                            <div className="flex gap-2">
                                {['#fcd34d', '#f87171', '#60a5fa', '#a3e635', '#ffffff', '#000000'].map(c =>
                                    <button key={c} onClick={() => setCustomization(p => ({ ...p, hair: c }))} className={`w-8 h-8 rounded-full border-2 ${customization.hair === c ? 'border-white' : 'border-transparent'}`} style={{ background: c }} />
                                )}
                            </div>
                        </div>
                        <div className="flex justify-center mt-6">
                            <Avatar form={levelInfo.current.form} action="idle" customization={customization} equipped={equipped} />
                        </div>
                        <button onClick={() => setShowEditor(false)} className="w-full mt-6 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-lg font-bold uppercase tracking-widest text-sm">Save Look</button>
                    </div>
                </div>
            );

            return (
                <div className="container mx-auto px-4 py-8 max-w-7xl h-screen flex flex-col relative text-slate-200">
                    {showEditor && <Editor />}

                    {/* HUD */}
                    <header className="flex justify-between items-center mb-6 relative z-10">
                        <div>
                            <h1 className="text-3xl tracking-[0.2em] text-white uppercase">Nous <strong className="text-blue-500 font-bold">Arcana</strong></h1>
                            <div className="flex items-center gap-4 text-sm text-slate-400 mt-1">
                                <span className="px-2 py-0.5 bg-blue-900/30 text-blue-300 rounded text-[10px] border border-blue-500/30">RPG V0.9 (Playground)</span>
                            </div>
                        </div>
                        <div className="flex gap-6 items-center">
                            <div className="text-right">
                                <div className="text-xs text-slate-400 uppercase tracking-wider">Balance</div>
                                <div className="text-2xl font-mono text-yellow-400 font-bold drop-shadow-[0_0_10px_rgba(250,204,21,0.3)]">{formatMoney(cash)}</div>
                            </div>
                        </div>
                    </header>

                    {/* Main Stage */}
                    <div className="grid grid-cols-12 gap-6 flex-grow min-h-0 relative z-10">

                        {/* LEFT: Hero */}
                        <div className="col-span-4 flex flex-col gap-4">
                            <div className="glass-panel p-6 flex flex-col items-center justify-center flex-grow relative overflow-hidden group">
                                <div className="absolute top-4 w-full text-center z-20">
                                    <h3 className="text-lg font-bold text-white tracking-wide">Player</h3>
                                    <div className="text-xs text-blue-300 uppercase tracking-widest">Level {levelInfo.current.level} {levelInfo.current.title}</div>
                                </div>
                                <button onClick={() => setShowEditor(true)} className="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition bg-white/10 hover:bg-white/20 p-2 rounded text-xs uppercase z-30">‚úèÔ∏è</button>
                                <div onClick={() => setShowEditor(true)} className="relative z-10 hover:scale-105 transition duration-500 cursor-pointer mt-8">
                                    <Avatar form={levelInfo.current.form} action={playerAction} damaged={hp < maxHp * 0.3} customization={customization} equipped={equipped} />
                                </div>
                                <div className="absolute bottom-4 left-4 flex gap-1">
                                    {['weapon', 'armor', 'offhand', 'feet', 'ring'].map(slot =>
                                        <div key={slot} className={`w-6 h-6 rounded border ${equipped[slot] ? 'bg-blue-500/20 border-blue-400' : 'bg-slate-900/40 border-slate-700'}`} title={slot}></div>
                                    )}
                                </div>
                                <div className="w-full mt-4 relative z-10 px-4">
                                    <div className="w-full h-1 bg-slate-800 rounded-full overflow-hidden">
                                        <div className="h-full bg-blue-500 shadow-[0_0_10px_#3b82f6]" style={{ width: `${progress}%`, transition: 'width 1s ease' }}></div>
                                    </div>
                                    <div className="text-[10px] text-center text-slate-500 mt-1">{Math.floor(xp)} / {levelInfo.next ? levelInfo.next.xp : 'MAX'} XP</div>
                                </div>
                            </div>
                            <div className="glass-panel p-4">
                                <div className="flex justify-between items-center mb-2">
                                    <h3 className="text-xs text-slate-400 uppercase tracking-widest font-bold">Health</h3>
                                    <span className={hp < maxHp * 0.3 ? 'text-red-400 font-bold' : 'text-green-400'}>{Math.floor(hp)}/{maxHp}</span>
                                </div>
                                <div className="w-full h-3 bg-slate-800 rounded-full overflow-hidden border border-slate-700 mb-4">
                                    <div className={`h-full transition-all duration-300 ${hp < maxHp * 0.3 ? 'bg-red-500' : 'bg-green-500'}`} style={{ width: `${(hp / maxHp) * 100}%` }}></div>
                                </div>
                                <h3 className="text-xs text-slate-400 uppercase tracking-widest font-bold mb-2 ml-1">Attributes</h3>
                                <div className="grid grid-cols-2 gap-x-4 px-1">
                                    <StatBadge lbl="STR" val={stats.str} color="stat-str" />
                                    <StatBadge lbl="AGI" val={stats.agi} color="stat-agi" />
                                    <StatBadge lbl="INT" val={stats.int} color="stat-int" />
                                    <StatBadge lbl="VIT" val={stats.vit} color="stat-vit" />
                                    <StatBadge lbl="WIS" val={stats.wis} color="stat-wis" />
                                    <StatBadge lbl="LUK" val={stats.luk} color="stat-luk" />
                                </div>
                            </div>
                        </div>

                        {/* MIDDLE: Combat */}
                        <div className="col-span-4 flex flex-col gap-6">
                            <div className="glass-panel p-6 flex-grow flex flex-col relative overflow-hidden">
                                <div className="absolute inset-0 bg-slate-900/50"></div>
                                <div className="relative z-10 flex-grow flex items-center justify-center">
                                    {monster ? (
                                        <div className="flex flex-col items-center gap-4">
                                            <div className={`text-6xl filter drop-shadow-2xl transition-transform ${monsterAction === 'attack' ? 'anim-slash' : 'anim-float'}`}>
                                                {monster.type === 'wisp' ? 'üëª' : monster.type === 'golem' ? 'üóø' : monster.type === 'dragon' ? 'üêâ' : monster.type === 'slime' ? 'üíß' : monster.type === 'shade' ? 'üåë' : 'üëπ'}
                                            </div>
                                            <div className="w-32 h-2 bg-slate-800 rounded-full overflow-hidden">
                                                <div className="h-full bg-red-500" style={{ width: `${(monster.currentHp / monster.maxHp) * 100}%` }}></div>
                                            </div>
                                            <h2 className="text-xl font-bold text-red-200 uppercase tracking-widest">{monster.name}</h2>
                                        </div>
                                    ) : (
                                        <div className="text-slate-600 text-center">
                                            <div className="text-6xl mb-2 opacity-20">‚öîÔ∏è</div>
                                            <p className="uppercase tracking-widest text-xs">No Active Threat</p>
                                        </div>
                                    )}
                                </div>
                                <div className="relative z-10 mt-6 grid grid-cols-2 gap-3">
                                    <button onClick={() => { setCash(p => p + 12.5); setXp(p => p + 62.5 * xpMultiplier); if (hp < maxHp) setHp(p => p + 1); addLog(`Studied 25m.`, 'success'); }} className="p-4 bg-slate-800 hover:bg-slate-700 border border-slate-600 rounded-xl transition flex flex-col items-center gap-1 group">
                                        <span className="text-2xl group-hover:scale-110 transition">üçÖ</span>
                                        <span className="text-xs uppercase font-bold text-slate-300">Focus 25m</span>
                                    </button>
                                    {!monster ? (
                                        <button onClick={() => { const rnd = ENEMIES[Math.floor(Math.random() * ENEMIES.length)]; setMonster({ ...rnd, currentHp: rnd.hp, maxHp: rnd.hp }); }} className="p-4 bg-indigo-900/50 hover:bg-indigo-800/50 border border-indigo-500/50 rounded-xl transition flex flex-col items-center gap-1 group">
                                            <span className="text-2xl group-hover:scale-110 transition">üëÅÔ∏è</span>
                                            <span className="text-xs uppercase font-bold text-indigo-300">Find Enemy</span>
                                        </button>
                                    ) : (
                                        <button onClick={combatRound} className="p-4 bg-red-900/60 hover:bg-red-800/80 border border-red-500 rounded-xl transition flex flex-col items-center gap-1 group shadow-[0_0_20px_rgba(220,38,38,0.3)]">
                                            <span className="text-2xl group-hover:rotate-12 transition">‚öîÔ∏è</span>
                                            <span className="text-xs uppercase font-bold text-white">Strike</span>
                                        </button>
                                    )}
                                </div>
                            </div>
                            <div className="glass-panel p-4 h-40 overflow-hidden relative">
                                <div className="absolute top-0 left-0 w-full h-8 bg-gradient-to-b from-slate-900 via-transparent to-transparent pointer-events-none z-10"></div>
                                <div className="h-full overflow-y-auto space-y-1 text-xs font-mono p-2">
                                    {logs.map((l, i) => (
                                        <div key={l.id || i} className={`p-1.5 rounded flex gap-2 ${l.type === 'danger' ? 'bg-red-900/20 text-red-300' : l.type === 'success' ? 'bg-green-900/20 text-green-300' : l.type === 'warning' ? 'bg-yellow-900/20 text-yellow-200' : 'text-slate-400'}`}>
                                            <span className="opacity-30">‚Ä∫</span> {l.msg}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* RIGHT: Market */}
                        <div className="col-span-4 flex flex-col h-full overflow-hidden glass-panel">
                            <div className="p-6 border-b border-white/5 bg-slate-900/30">
                                <h3 className="uppercase tracking-widest text-sm font-bold text-white">Market</h3>
                            </div>
                            <div className="flex-1 overflow-y-auto p-4 space-y-3">
                                {ITEMS.map(item => {
                                    const owned = inventory.some(i => i.id === item.id) && item.type !== 'consumable';
                                    return (
                                        <button key={item.id} onClick={() => buy(item)} disabled={cash < item.cost || owned} className={`w-full p-3 rounded-xl border flex items-center gap-4 transition group relative overflow-hidden ${owned ? 'bg-slate-800/20 border-slate-700 opacity-50' : cash >= item.cost ? 'bg-slate-800/40 hover:bg-slate-700/60 cursor-pointer' : 'bg-slate-900/50 opacity-50 cursor-not-allowed'} rarity-${item.rarity}`}>
                                            <div className="text-2xl relative z-10">{item.icon}</div>
                                            <div className="flex-1 text-left relative z-10">
                                                <div className="text-sm font-bold text-slate-200 group-hover:text-white transition">{item.name}</div>
                                                <div className="text-[10px] uppercase tracking-wide text-slate-500 flex gap-2 flex-wrap">{item.type === 'consumable' ? <span>{item.desc}</span> : Object.entries(item.stats).map(([k, v]) => <span key={k} className={`stat-${k}`}>+{v} {k.toUpperCase()}</span>)}</div>
                                            </div>
                                            <div className="text-right relative z-10">{owned ? <div className="text-slate-600 text-xs">SOLD</div> : <div className={`font-mono font-bold ${cash >= item.cost ? 'text-green-400' : 'text-red-400'}`}>{formatMoney(item.cost)}</div>}</div>
                                        </button>
                                    );
                                })}
                            </div>
                            <div className="p-4 bg-slate-950/50 border-t border-white/5">
                                <h4 className="text-[10px] uppercase tracking-widest text-slate-600 mb-2">Inventory (Double Click)</h4>
                                <div className="flex gap-2 flex-wrap">
                                    {inventory.map((item, i) => {
                                        const isEquipped = item.type === 'gear' && equipped[item.slot] === item.id;
                                        return <div key={i} onDoubleClick={() => handleEquip(item)} className={`w-10 h-10 rounded bg-slate-800 flex items-center justify-center text-lg border relative cursor-pointer hover:scale-110 transition rarity-${item.rarity} ${isEquipped ? 'ring-2 ring-blue-500 ring-offset-2 ring-offset-slate-900 bg-blue-900/20' : ''}`} title={item.name}>{item.icon}</div>;
                                    })}
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>