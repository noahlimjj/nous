<!DOCTYPE html>
<html>
<head>
    <title>Debug Admin Status</title>
    <script src="config.js"></script>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, getDoc, collection, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const app = initializeApp(window.firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        onAuthStateChanged(auth, async (user) => {
            const output = document.getElementById('output');

            if (user) {
                output.innerHTML += `<p>âœ… Logged in as: ${user.email || user.uid}</p>`;

                // Check user profile
                const userDocRef = doc(db, 'users', user.uid);
                const userDoc = await getDoc(userDocRef);

                if (userDoc.exists()) {
                    const data = userDoc.data();
                    output.innerHTML += `<p>ğŸ“‹ Username: ${data.username}</p>`;
                    output.innerHTML += `<p>ğŸ›¡ï¸ Admin field exists: ${data.hasOwnProperty('admin') ? 'YES' : 'NO'}</p>`;
                    output.innerHTML += `<p>ğŸ›¡ï¸ Admin value: ${data.admin}</p>`;
                    output.innerHTML += `<p>ğŸ“ Full data: <pre>${JSON.stringify(data, null, 2)}</pre></p>`;

                    if (data.admin === true) {
                        output.innerHTML += `<p style="color: green; font-weight: bold;">âœ… ADMIN STATUS IS TRUE - Panel should show!</p>`;
                    } else {
                        output.innerHTML += `<p style="color: red; font-weight: bold;">âŒ Admin is not true. Check Firebase Console.</p>`;
                    }
                } else {
                    output.innerHTML += `<p>âŒ User document not found</p>`;
                }
            } else {
                output.innerHTML += `<p>âŒ Not logged in. Please log in first.</p>`;
            }
        });
    </script>
</head>
<body style="font-family: Arial; padding: 20px;">
    <h1>ğŸ” Admin Status Debugger</h1>
    <p>This page will show your admin status.</p>
    <div id="output"></div>
    <br>
    <p><a href="index.html">â† Back to main app</a></p>
</body>
</html>
